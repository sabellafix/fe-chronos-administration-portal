<div class="calendar-canvas calendar-monthly mt-0 no-border no-box-shadow animated fadeIn fast" id="calendar-monthly-header">
    <div class="calendar-container">
        <table class="calendar-table mt-1">
            <thead>
                <tr>
                    <th class="day-header text-center" *ngFor="let dayName of daysOfWeek" >
                        <div class="day-header-content" >
                            <div class="card w-100 bg-light p-2 card-date text-center" [ngClass]="{'today': isToday(dayName)}">
                                <p class="font-size-14 fw-normal mb-1 capitalize mb-0">{{dayName}}</p>
                            </div>
                        </div>
                    </th>
                </tr>
            </thead>
        </table>
    </div>
</div>

<div style="margin-top: 52px !important" class="calendar-canvas calendar-body mt-0 no-border no-box-shadow animated fadeIn fast">
    <div class="calendar-container">

        <!-- Indicador de carga -->
        <!-- <div *ngIf="isLoadingBookings" class="d-flex justify-content-center align-items-center p-4">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Cargando citas...</span>
            </div>
            <span class="ms-2 text-muted">Cargando citas...</span>
        </div> -->

        <table class="calendar-table animated fadeIn fast" *ngIf="!isLoadingBookings">
            <tbody>
                <tr class="week-row" *ngFor="let week of monthDays; trackBy: trackByWeek">
                    <td class="day-cell" 
                        *ngFor="let dayItem of week; trackBy: trackByDay"
                        [class.today]="dayItem.isToday"
                        [class.other-month]="!dayItem.isCurrentMonth"
                        [class.disabled]="dayItem.isDisabled"
                        [class.has-bookings]="hasBookings(dayItem.date)"
                        (click)="!dayItem.isDisabled && openBookingModal(dayItem.date)">
                        
                        <div class="day-content">
                            <div class="day-number" 
                                 [class.current-month]="dayItem.isCurrentMonth"
                                 [class.other-month-number]="!dayItem.isCurrentMonth">
                                {{dayItem.date.getDate()}}
                            </div>
                            
                            <div class="day-bookings" *ngIf="hasBookings(dayItem.date)">
                                <div class="booking-item-compact" 
                                     *ngFor="let booking of getBookingsForDate(dayItem.date); let i = index; trackBy: trackByBooking"
                                     [class.multiple-services]="booking.services && booking.services.length > 1"
                                     [style.background-color]="booking.services?.[0]?.color || '#23324d'"
                                     [title]="getBookingTooltip(booking)">
                                    
                                    <div class="booking-compact-info">
                                        <div class="booking-header-row">
                                            <div class="customer-info">
                                                <!-- <img class="customer-photo" [src]="booking.customer.photo" alt="Customer"> -->
                                                <span class="customer-name">{{booking.customer.firstName}}</span>
                                            </div>
                                            
                                            <div class="booking-time align-items-end">
                                                <i class="bx bx-time text-white me-1"></i>
                                                <span class="text-white">{{booking.startTime | timeOnly}} - {{booking.endTime | timeOnly}}</span>
                                            </div>
                                        </div>
                                        
                                        <!-- <div class="booking-details">
                                            <div class="services-compact" *ngIf="booking.services && booking.services.length > 0">
                                                <span class="service-badge"  
                                                      *ngFor="let service of booking.services.slice(0, 2); let serviceIndex = index"
                                                      [style.background-color]="serviceIndex === 0 ? 'rgba(255,255,255,0.9)' : 'rgba(255,255,255,0.7)'"
                                                     >
                                                    {{service.serviceName}}
                                                </span>
                                               
                                            </div>
                                        </div> -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<app-offcanvas-create-booking 
  (bookingCreated)="onBookingCreated($event)"
  (cancelled)="onBookingCancelled()">
</app-offcanvas-create-booking>